# 盘了么 - 冒烟测试用例

## 测试目的
通过UI操作验证应用的主要功能是否正常工作，确保核心流程可用。

## 测试环境准备

### 前置条件
1. 应用已成功安装到设备/模拟器
2. 设备已连接网络
3. 准备一个有效的 DeepSeek API Key（用于测试API功能）

### 测试设备
- [ ] iOS 设备/模拟器
- [ ] Android 设备/模拟器

---

## 测试用例

### 1. 应用启动与初始化

**测试步骤：**
1. 启动应用
2. 观察应用启动过程

**预期结果：**
- [ ] 应用正常启动，无崩溃
- [ ] 显示引导页面（GuidePage），包含4个话题卡片：
  - 高兴的三件事
  - 日常记录
  - 点子王
  - 死了么
- [ ] 页面布局正常，Logo和文字显示正确

**检查点：**
- 应用启动时间合理（< 3秒）
- UI元素完整显示
- 无白屏或黑屏

---

### 2. 设置功能 - API Key 配置

**测试步骤：**
1. 点击左上角菜单按钮（☰）
2. 点击底部"设置"选项
3. 在"API 配置"区域输入 API Key（格式：sk-...）
4. 点击"验证并保存"按钮
5. 等待验证完成

**预期结果：**
- [ ] 设置页面正常打开
- [ ] API Key 输入框可正常输入
- [ ] 点击眼睛图标可以显示/隐藏 API Key
- [ ] 验证成功后显示成功提示
- [ ] 返回聊天页面后，显示已配置状态（Key: sk-...xxx，带绿色对勾）
- [ ] 如果 API Key 无效，显示验证失败提示

**检查点：**
- 输入框响应正常
- 验证过程有加载状态提示
- 验证结果反馈明确
- 配置状态正确保存

---

### 3. 聊天功能 - 选择话题并开始对话

**测试步骤：**
1. 在引导页面，点击"高兴的三件事"卡片
2. 观察页面变化
3. 查看助手初始消息

**预期结果：**
- [ ] 成功切换到聊天界面
- [ ] 显示助手欢迎消息："你好呀～我是你的专属觉察助手😘..."
- [ ] 页面顶部显示"高兴的三件事"标题
- [ ] 输入框显示占位符文字
- [ ] 输入框和发送按钮可用

**检查点：**
- 页面切换流畅
- 消息显示正常（支持Markdown格式）
- UI布局正确

---

### 4. 发送消息功能

**测试步骤：**
1. 在输入框中输入："今天吃了一顿好吃的火锅"
2. 点击发送按钮（或按回车）
3. 观察消息发送过程
4. 等待AI回复

**预期结果：**
- [ ] 用户消息立即显示在聊天界面
- [ ] 用户消息显示在右侧（用户侧）
- [ ] 发送后输入框清空
- [ ] 显示AI正在输入的提示（流式响应）
- [ ] AI回复逐步显示（打字机效果）
- [ ] AI回复显示在左侧（助手侧）
- [ ] AI回复内容符合"高兴的三件事"助手的角色设定

**检查点：**
- 消息发送无延迟
- 流式响应正常工作
- 消息格式正确（Markdown渲染）
- 对话上下文正确

---

### 5. 消息操作 - 复制和删除

**测试步骤：**
1. 长按任意一条消息（用户或AI消息）
2. 查看弹出的操作菜单
3. 点击"复制"
4. 验证复制功能
5. 再次长按消息，点击"删除"
6. 确认删除操作

**预期结果：**
- [ ] 长按消息后显示操作菜单（复制、删除）
- [ ] 点击"复制"后，消息内容被复制到剪贴板
- [ ] Android显示"已复制"提示
- [ ] 点击"删除"后显示确认对话框
- [ ] 确认删除后，消息从界面消失
- [ ] 删除后会话状态正确保存

**检查点：**
- 长按手势识别正常
- 菜单显示位置合理
- 复制功能正常（可粘贴验证）
- 删除确认机制安全

---

### 6. 切换话题功能

**测试步骤：**
1. 点击页面顶部标题（"高兴的三件事"）
2. 在弹出的选择器中点击"日常记录"
3. 观察页面变化

**预期结果：**
- [ ] 弹出话题选择器（Modal）
- [ ] 显示所有4个话题选项
- [ ] 当前话题显示选中标记（✓）
- [ ] 点击"日常记录"后，话题切换成功
- [ ] 显示"日常记录"助手的初始消息
- [ ] 当前会话保存，新会话开始

**检查点：**
- Modal显示正常
- 话题切换流畅
- 会话状态正确保存和切换

---

### 7. 侧边栏 - 会话管理

**测试步骤：**
1. 发送几条消息创建会话
2. 点击左上角菜单按钮打开侧边栏
3. 查看会话列表
4. 点击"新会话"按钮
5. 点击历史会话项
6. 长按历史会话项

**预期结果：**
- [ ] 侧边栏正常打开
- [ ] 显示"新会话"按钮
- [ ] 历史记录区域显示已创建的会话
- [ ] 会话标题格式正确（如："高兴的三件事-2026/1/25"）
- [ ] 当前会话高亮显示
- [ ] 点击"新会话"后，创建新的空白会话
- [ ] 点击历史会话后，加载该会话的消息
- [ ] 长按会话后，显示删除确认对话框
- [ ] 删除会话后，会话从列表中消失

**检查点：**
- 侧边栏动画流畅
- 会话列表正确显示
- 会话切换功能正常
- 删除功能安全可靠

---

### 8. 生成复盘功能（日常记录）

**测试步骤：**
1. 切换到"日常记录"话题
2. 发送几条记录消息（如："早上8点起床"、"中午吃了饭"）
3. 点击右上角的"生成复盘"按钮（✨图标）
4. 确认生成操作
5. 等待复盘生成完成

**预期结果：**
- [ ] "日常记录"话题显示"生成复盘"按钮
- [ ] 点击后显示确认对话框
- [ ] 确认后开始生成复盘
- [ ] 显示流式响应过程
- [ ] 复盘内容按时间顺序整理
- [ ] 复盘格式符合要求（包含开篇、流水账、结尾感悟）
- [ ] 会话标题更新为"今日复盘-日期"

**检查点：**
- 只有支持复盘的话题显示按钮
- 复盘生成过程流畅
- 复盘内容准确（基于实际记录）
- 时间顺序正确

---

### 9. 继续之前的会话

**测试步骤：**
1. 在引导页面，点击"日常记录"
2. 发送一条消息
3. 返回引导页面（点击右上角编辑按钮）
4. 再次点击"日常记录"

**预期结果：**
- [ ] 如果当天已有该话题的会话，显示提示对话框
- [ ] 对话框提供两个选项："继续之前的"和"开始新的"
- [ ] 选择"继续之前的"后，加载之前的会话
- [ ] 选择"开始新的"后，创建新会话

**检查点：**
- 会话检测逻辑正确（凌晨2点前算前一天）
- 提示对话框清晰明确
- 两种选择都能正常工作

---

### 10. 清除 API Key

**测试步骤：**
1. 进入设置页面
2. 点击"清除 API Key"按钮
3. 确认清除操作

**预期结果：**
- [ ] 显示确认对话框
- [ ] 确认后，API Key 被清除
- [ ] 设置页面恢复为未配置状态
- [ ] 返回聊天页面后，如果尝试发送消息，应提示需要配置API Key

**检查点：**
- 清除操作有确认机制
- 清除后状态正确更新
- 未配置状态下功能受限

---

### 11. 错误处理 - API 错误

**测试步骤：**
1. 配置一个无效的 API Key
2. 发送一条消息
3. 观察错误处理

**预期结果：**
- [ ] 如果 API Key 无效（401），显示"认证失败"提示
- [ ] 提示包含"去配置"按钮
- [ ] 点击"去配置"后跳转到设置页面
- [ ] 如果余额不足（402），显示"余额不足"提示

**检查点：**
- 错误提示清晰明确
- 错误处理流程合理
- 用户可以快速修复问题

---

### 12. 应用返回键处理（Android）

**测试步骤：**
1. 在Android设备上，按返回键
2. 观察提示
3. 2秒内再次按返回键

**预期结果：**
- [ ] 第一次按返回键，显示"再按一次退出应用"提示
- [ ] 2秒内再次按返回键，应用退出
- [ ] 超过2秒后按返回键，重新开始计时

**检查点：**
- 返回键处理符合Android规范
- 防止误退出机制有效

---

## 测试结果记录

### 测试日期：___________

### 测试人员：___________

### 测试环境：
- 设备型号：___________
- 操作系统版本：___________
- 应用版本：___________

### 测试结果汇总：

| 测试用例 | 通过/失败 | 备注 |
|---------|----------|------|
| 1. 应用启动与初始化 | ☐ 通过 ☐ 失败 | |
| 2. 设置功能 - API Key 配置 | ☐ 通过 ☐ 失败 | |
| 3. 聊天功能 - 选择话题 | ☐ 通过 ☐ 失败 | |
| 4. 发送消息功能 | ☐ 通过 ☐ 失败 | |
| 5. 消息操作 - 复制和删除 | ☐ 通过 ☐ 失败 | |
| 6. 切换话题功能 | ☐ 通过 ☐ 失败 | |
| 7. 侧边栏 - 会话管理 | ☐ 通过 ☐ 失败 | |
| 8. 生成复盘功能 | ☐ 通过 ☐ 失败 | |
| 9. 继续之前的会话 | ☐ 通过 ☐ 失败 | |
| 10. 清除 API Key | ☐ 通过 ☐ 失败 | |
| 11. 错误处理 - API 错误 | ☐ 通过 ☐ 失败 | |
| 12. 应用返回键处理 | ☐ 通过 ☐ 失败 | |

### 发现的问题：

1. **问题描述：**
   - 复现步骤：
   - 预期结果：
   - 实际结果：
   - 严重程度：☐ 严重 ☐ 中等 ☐ 轻微

2. **问题描述：**
   - 复现步骤：
   - 预期结果：
   - 实际结果：
   - 严重程度：☐ 严重 ☐ 中等 ☐ 轻微

---

## 测试通过标准

### 必须通过的核心功能（P0）：
- [ ] 应用正常启动
- [ ] API Key 配置和验证
- [ ] 选择话题并开始对话
- [ ] 发送消息并接收AI回复
- [ ] 会话保存和加载

### 重要功能（P1）：
- [ ] 消息复制和删除
- [ ] 切换话题
- [ ] 会话管理（创建、切换、删除）
- [ ] 错误处理

### 次要功能（P2）：
- [ ] 生成复盘功能
- [ ] 继续之前的会话
- [ ] 清除 API Key
- [ ] 返回键处理

---

## 测试建议

1. **测试顺序**：建议按照用例编号顺序执行，因为后续用例可能依赖前面的功能
2. **测试数据**：准备不同类型的测试消息，验证AI回复的多样性
3. **边界测试**：测试空消息、超长消息、特殊字符等边界情况
4. **性能测试**：关注消息发送响应时间、流式响应流畅度
5. **兼容性测试**：在不同设备尺寸和系统版本上测试

---

## 快速冒烟测试（5分钟版本）

如果时间有限，可以执行以下核心流程：

1. ✅ 启动应用 → 检查引导页面
2. ✅ 配置 API Key → 验证成功
3. ✅ 选择"日常记录"话题 → 发送一条消息 → 确认收到回复
4. ✅ 打开侧边栏 → 查看会话列表
5. ✅ 长按消息 → 测试复制功能
6. ✅ 切换话题 → 确认切换成功

如果以上6个步骤都能正常完成，说明核心功能基本可用。

---

## 更新日志

- 2026-01-25: 创建初始版本
